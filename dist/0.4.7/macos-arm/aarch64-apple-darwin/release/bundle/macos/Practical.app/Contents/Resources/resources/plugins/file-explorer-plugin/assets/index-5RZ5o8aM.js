(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function f(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}let p;const g=new Uint8Array(16);function h(){if(!p){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");p=crypto.getRandomValues.bind(crypto)}return p(g)}const v=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),m={randomUUID:v};function w(e,t,o){e=e||{};const r=e.random??e.rng?.()??h();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,f(r)}function L(e,t,o){return m.randomUUID&&!e?m.randomUUID():w(e)}class R{pendingRequests=new Map;onWorkspaceChanged=()=>{};constructor(){window.addEventListener("message",t=>{const{type:o,payload:r}=t.data||{};if(o)if(o.endsWith(".response")){const{requestId:n}=r,s=this.pendingRequests.get(n);s&&(s(r),this.pendingRequests.delete(n))}else o==="workspace.changed"&&this.onWorkspaceChanged(r)})}async readDir(t){return this.sendRequest("vfs.readDir",{path:t})}async readFile(t){return this.sendRequest("vfs.readFile",{path:t})}async openFile(t){return this.sendRequest("editor.openFile",{path:t})}async getWorkspaceDetails(){return this.sendRequest("workspace.getDetails",{})}sendRequest(t,o){const r=L();return new Promise(n=>{this.pendingRequests.set(r,n),window.parent.postMessage({type:t,payload:{...o,requestId:r}},"*")})}}const a=new R,c=document.getElementById("app");function W(e,t){return t==="directory"?"ğŸ“":e.endsWith(".md")?"ğŸ“":e.endsWith(".json")?"ğŸ”§":e.endsWith(".csv")?"ğŸ“Š":e.endsWith(".png")||e.endsWith(".jpg")?"ğŸ–¼ï¸":"ğŸ“„"}async function u(e="/"){if(!c)return;c.innerHTML='<div class="empty-state">Loading...</div>';const t=await a.readDir(e);if(!t.success){c.innerHTML=`<div style="color: red; padding: 10px;">Error: ${t.error}</div>`;return}const o=t.data;if(c.innerHTML="",e!=="/"&&e!==""){const n=document.createElement("div");n.className="up-btn",n.innerHTML='<span class="icon">â¬†ï¸</span> ..',n.onclick=()=>{const s=e.split("/").slice(0,-1).join("/")||"/";u(s)},c.appendChild(n)}if(o.length===0){const n=document.createElement("div");n.className="empty-state",n.textContent="Empty folder",c.appendChild(n);return}const r=document.createElement("ul");o.sort((n,s)=>n.type===s.type?n.name.localeCompare(s.name):n.type==="directory"?-1:1);for(const n of o){const s=document.createElement("li"),d=W(n.name,n.type);s.innerHTML=`<span class="icon">${d}</span> ${n.name}`,s.onclick=async y=>{if(y.stopPropagation(),n.type==="directory"){const l=`${e}${e.endsWith("/")?"":"/"}${n.name}`;u(l)}else{const l=`${e}${e.endsWith("/")?"":"/"}${n.name}`;await a.openFile(l)}},r.appendChild(s)}c.appendChild(r)}a.onWorkspaceChanged=e=>{console.log("Workspace changed:",e),e.isOpen?u("/"):c&&(c.innerHTML='<div class="empty-state">No workspace open</div>')};a.getWorkspaceDetails().then(e=>{e.success&&e.data.isOpen?u("/"):c&&(c.innerHTML='<div class="empty-state">No workspace open</div>')});
